import{_ as t,c as h,b as n,d as i,e,f as l,a as r,r as p,o as k}from"./app-BNynu8vQ.js";const d={};function c(o,s){const a=p("RouteLink");return k(),h("div",null,[n("p",null,[s[1]||(s[1]=i("åœ¨ Nginx ä¸­ï¼Œå¯ä»¥å°†å„ä¸ªæœåŠ¡ä½¿ç”¨ä¸åŒçš„äºŒçº§åŸŸååå‘ä»£ç†åˆ°å…¬ç½‘ï¼Œé…åˆé˜²ç«å¢™ä»…æš´éœ²æœåŠ¡å™¨çš„å°éƒ¨åˆ†ç«¯å£ï¼Œä»è€Œæé«˜å®‰å…¨æ€§ã€‚ğŸ’¡ PSï¼šå½“åˆå¹´å°‘ä¸æ‡‚äº‹ï¼Œæ›¾å°†æ‰€æœ‰ç«¯å£æš´éœ²åˆ°å…¬ç½‘ï¼ŒåŒ…æ‹¬ ")),e(a,{to:"/nas/basic/9-v2rayn.html"},{default:l(()=>s[0]||(s[0]=[i("V2rayN ä»£ç†")])),_:1}),s[2]||(s[2]=i(" æœåŠ¡ï¼Œç»“æœè¢«æŸä½æ³•å›½å¤§å…„å¼Ÿåœ¨çŸ­çŸ­ä¸‰å››ä¸ªå°æ—¶å†…å¸å¹²äº†æœºåœºæµé‡ã€‚æƒ³æƒ³è‡ªå·±å½“åˆå°†ä»£ç†ç«¯å£æ— åŠ å¯†æš´éœ²åˆ°å…¬ç½‘ï¼ŒçœŸæ˜¯ä¸ªç‹¼äººçš„æ“ä½œã€‚ğŸº"))]),s[6]||(s[6]=n("h2",{id:"ğŸš€-é€šè¿‡-portainer-stacks-å®‰è£…-nginx",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ğŸš€-é€šè¿‡-portainer-stacks-å®‰è£…-nginx"},[n("span",null,"ğŸš€ é€šè¿‡ Portainer Stacks å®‰è£… Nginx")])],-1)),n("p",null,[s[4]||(s[4]=i("ä¸ ")),e(a,{to:"/nas/basic/3-ddns-go.html"},{default:l(()=>s[3]||(s[3]=[i("DDNS-GO")])),_:1}),s[5]||(s[5]=i(" ä¸­çš„åšæ³•ç›¸åŒï¼Œé‡‡ç”¨åœ¨ Portainer Stacks ä¸­æ·»åŠ  Docker Compose æ–‡ä»¶çš„æ–¹å¼éƒ¨ç½² Nginx å®¹å™¨ã€‚ä»¥ä¸‹æ˜¯ Docker Compose æ–‡ä»¶çš„ç¤ºä¾‹ï¼š"))]),s[7]||(s[7]=r(`<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">services:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  nginx:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    restart:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> always</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    container_name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    image:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    volumes:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/nginx/conf.d:/etc/nginx/conf.d</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/nginx/nginx.conf:/etc/nginx/nginx.conf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/letsencrypt:/etc/letsencrypt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/log/nginx:/var/log/nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    environment:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> NGINX_PORT=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TZ=Asia/Shanghai</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    privileged:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    network_mode:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> host</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ğŸ“œ-æ–‡ä»¶ä¸­å‚æ•°å®šä¹‰å¦‚ä¸‹" tabindex="-1"><a class="header-anchor" href="#ğŸ“œ-æ–‡ä»¶ä¸­å‚æ•°å®šä¹‰å¦‚ä¸‹"><span>ğŸ“œ æ–‡ä»¶ä¸­å‚æ•°å®šä¹‰å¦‚ä¸‹ï¼š</span></a></h3><ol><li><strong>é‡å¯ç­–ç•¥</strong>ï¼šè®¾ç½®ä¸º <code>always</code>ï¼Œè¡¨ç¤ºå¦‚æœå®¹å™¨åœæ­¢ï¼ŒDocker ä¼šè‡ªåŠ¨é‡å¯å®ƒã€‚</li><li><strong>å®¹å™¨åç§°</strong>ï¼šæŒ‡å®šå®¹å™¨çš„åç§°ä¸º <code>nginx</code>ã€‚</li><li><strong>é•œåƒ</strong>ï¼šä½¿ç”¨å®˜æ–¹çš„ <code>nginx</code> é•œåƒã€‚</li><li><strong>æŒ‚è½½å·</strong>ï¼š <ul><li>å°†ä¸»æœºçš„ <code>/etc/nginx/conf.d</code> ç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ <code>/etc/nginx/conf.d</code>ï¼Œç”¨äºé…ç½®æ–‡ä»¶ã€‚</li><li>å°†ä¸»æœºçš„ <code>/etc/nginx/nginx.conf</code> æ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨çš„ <code>/etc/nginx/nginx.conf</code>ï¼Œç”¨äºä¸»é…ç½®æ–‡ä»¶ã€‚</li><li>å°†ä¸»æœºçš„ <code>/etc/letsencrypt</code> ç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ <code>/etc/letsencrypt</code>ï¼Œç”¨äº SSL è¯ä¹¦ã€‚</li><li>å°†ä¸»æœºçš„ <code>/var/log/nginx</code> ç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ <code>/var/log/nginx</code>ï¼Œç”¨äºæ—¥å¿—æ–‡ä»¶ã€‚</li></ul></li><li><strong>ç¯å¢ƒå˜é‡</strong>ï¼š <ul><li><code>NGINX_PORT</code> è®¾ç½®ä¸º 80ï¼ŒæŒ‡å®š Nginx ç›‘å¬çš„ç«¯å£ã€‚</li><li><code>TZ</code> è®¾ç½®ä¸º <code>Asia/Shanghai</code>ï¼ŒæŒ‡å®šæ—¶åŒºã€‚</li></ul></li><li><strong>ç‰¹æƒæ¨¡å¼</strong>ï¼šè®¾ç½®ä¸º <code>true</code>ï¼Œå…è®¸å®¹å™¨è·å¾—é¢å¤–çš„æƒé™ã€‚</li><li><strong>ç½‘ç»œæ¨¡å¼</strong>ï¼šè®¾ç½®ä¸º <code>host</code>ï¼Œè¡¨ç¤ºå®¹å™¨å°†ä½¿ç”¨ä¸»æœºçš„ç½‘ç»œæ ˆï¼Œå®¹å™¨å’Œä¸»æœºå…±äº«ç½‘ç»œã€‚</li></ol><p>ä¸å…¶ä»–é•œåƒä¸åŒçš„æ˜¯ï¼Œéƒ¨ç½² Nginx å®¹å™¨æ—¶ï¼Œå®¹å™¨ä¸­å¹¶æ²¡æœ‰ä¸€ä¸ª <code>/etc/nginx/nginx.conf</code> ä¸»é…ç½®æ–‡ä»¶ï¼ˆå¤§éƒ¨åˆ†é•œåƒéƒ½ä¼šå­˜åœ¨ä¸€ä¸ªé»˜è®¤é…ç½®æ–‡ä»¶ï¼Œç›´æ¥å°†å…¶æ˜ å°„åˆ°å®¿ä¸»æœºï¼Œåœ¨å…¶åŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹ï¼‰ã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œè‹¥ç›´æ¥éƒ¨ç½² Nginx é•œåƒï¼Œå®¹å™¨ä¼šæŠ¥é”™é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ã€‚å› æ­¤ï¼Œéœ€è¦åœ¨å®¿ä¸»æœºä¸Šåˆ›å»ºä¸€ä¸ªä¸»é…ç½®æ–‡ä»¶ï¼Œå¹¶å°†å…¶æ˜ å°„åˆ°å®¹å™¨å†…éƒ¨ã€‚</p><h3 id="ğŸ’¡-tips" tabindex="-1"><a class="header-anchor" href="#ğŸ’¡-tips"><span>ğŸ’¡ Tips</span></a></h3><p>å½“å®¿ä¸»æœºçš„ A æ–‡ä»¶ï¼ˆæ–‡ä»¶å¤¹ï¼‰ä¸å®¹å™¨çš„ B æ–‡ä»¶ï¼ˆæ–‡ä»¶å¤¹ï¼‰åˆ›å»ºæ˜ å°„å…³ç³»æ—¶ï¼Œå¯èƒ½äº§ç”Ÿçš„ç»“æœå¦‚ä¸‹ï¼š</p><ol><li><strong>Aå­˜åœ¨ï¼ŒBä¸å­˜åœ¨</strong>ï¼šDocker ä¼šåœ¨å®¹å™¨å†…åˆ›å»ºä¸€ä¸ªç©ºç›®å½• Bï¼Œå¹¶å°†å®¿ä¸»æœºçš„ A ç›®å½•æŒ‚è½½åˆ° B ä¸Šã€‚å®¹å™¨å†…çš„ B ç›®å½•å°†æ˜¾ç¤º A çš„å†…å®¹ã€‚</li><li><strong>Aå­˜åœ¨ï¼ŒBå­˜åœ¨</strong>ï¼šDocker ä¼šå°†å®¿ä¸»æœºçš„ A ç›®å½•æŒ‚è½½åˆ°å®¹å™¨å†…çš„ B ç›®å½•ï¼Œå®¹å™¨å†…çš„ B ç›®å½•å†…å®¹å°†ä¸å®¿ä¸»æœºçš„ A ç›®å½•ç›¸åŒã€‚å®¹å™¨å†… B çš„åŸæœ‰å†…å®¹å°†è¢«éšè—ï¼Œä½†ä¸ä¼šåˆ é™¤ã€‚</li><li><strong>Aä¸å­˜åœ¨ï¼ŒBä¸å­˜åœ¨</strong>ï¼šDocker ä¼šåœ¨å®¹å™¨å†…åˆ›å»ºä¸€ä¸ªç©ºç›®å½• Bï¼Œå› ä¸ºæ²¡æœ‰å®¿ä¸»æœºçš„ A è¿›è¡ŒæŒ‚è½½ã€‚</li><li><strong>Aä¸å­˜åœ¨ï¼ŒBå­˜åœ¨</strong>ï¼šå®¹å™¨å†…çš„ B ç›®å½•å°†ä¿æŒä¸å˜ï¼ŒDocker ä¸ä¼šå¯¹å…¶è¿›è¡Œä»»ä½•æ“ä½œï¼ŒB çš„å†…å®¹ä¸ä¼šä¸å®¿ä¸»æœºçš„ A è¿›è¡Œå…³è”ã€‚</li></ol><h3 id="ğŸ”‘-æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ”‘-æ€»ç»“"><span>ğŸ”‘ æ€»ç»“</span></a></h3><p>æŒ‚è½½æ—¶ï¼Œå®¿ä¸»æœºçš„ç›®å½•ä¼˜å…ˆçº§é«˜äºå®¹å™¨å†…çš„ç›®å½•ï¼Œå®¿ä¸»æœºçš„å†…å®¹ä¼šè¦†ç›–å®¹å™¨å†…çš„å†…å®¹ã€‚</p><h3 id="ğŸ“-åˆ›å»ºé…ç½®æ–‡ä»¶-etc-nginx-nginx-conf" tabindex="-1"><a class="header-anchor" href="#ğŸ“-åˆ›å»ºé…ç½®æ–‡ä»¶-etc-nginx-nginx-conf"><span>ğŸ“ åˆ›å»ºé…ç½®æ–‡ä»¶ <code>/etc/nginx/nginx.conf</code></span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">worker_processes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> auto</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">events</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        worker_connections</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 768</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # multi_accept on;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">http</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        sendfile</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        tcp_nopush</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        types_hash_max_size</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2048</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/nginx/mime.types</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        default_type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> application/octet-stream</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        ssl_protocols</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TLSv1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TLSv1.1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TLSv1.2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TLSv1.3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Dropping SSLv3, ref: POODLE</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        ssl_prefer_server_ciphers</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        client_max_body_size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 8192M</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/nginx/conf.d/</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.conf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/nginx/sites-enabled/</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ğŸ“‚-åˆ›å»ºæ–‡ä»¶å¤¹-etc-nginx-conf-d" tabindex="-1"><a class="header-anchor" href="#ğŸ“‚-åˆ›å»ºæ–‡ä»¶å¤¹-etc-nginx-conf-d"><span>ğŸ“‚ åˆ›å»ºæ–‡ä»¶å¤¹ <code>/etc/nginx/conf.d</code></span></a></h3><p>åœ¨å…¶ä¸­åˆ›å»º <code>portainer.conf</code> æ–‡ä»¶ï¼Œå†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">upstream</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> portainer</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> localhost:9000</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    listen</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       12120</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ssl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ç«¯å£</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    server_name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  portainer.domain.com</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># äºŒçº§åŸŸåæ”¹ä¸º portainer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # è¯ä¹¦</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    ssl_certificate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/letsencrypt/live/domain.com/fullchain.pem</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    ssl_certificate_key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/letsencrypt/live/domain.com/privkey.pem</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    ssl_session_timeout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 5m</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    ssl_protocols</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TLSv1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TLSv1.1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TLSv1.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    ssl_ciphers</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    ssl_prefer_server_ciphers</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    location</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        proxy_http_version</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        proxy_set_header</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Upgrade</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $http_upgrade</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        proxy_set_header</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Connection</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;upgrade&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        proxy_pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://portainer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ğŸ”-å„éƒ¨åˆ†çš„è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#ğŸ”-å„éƒ¨åˆ†çš„è§£é‡Š"><span>ğŸ” å„éƒ¨åˆ†çš„è§£é‡Šï¼š</span></a></h3><ol><li><strong>upstream portainer</strong>: å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>portainer</code> çš„ä¸Šæ¸¸æœåŠ¡å™¨ï¼ŒæŒ‡å‘ <code>localhost:9002</code>ï¼Œå³ Portainer æœåŠ¡è¿è¡Œçš„åœ°å€ã€‚</li><li><strong>server { ... }</strong>: å®šä¹‰äº†ä¸€ä¸ª Nginx æœåŠ¡å™¨å—ï¼ŒåŒ…å«ç›‘å¬çš„ç«¯å£å’ŒåŸŸåç­‰é…ç½®ã€‚</li><li><strong>listen 12120 ssl;</strong>: æŒ‡å®šæœåŠ¡å™¨ç›‘å¬ 12120 ç«¯å£ï¼Œå¹¶å¯ç”¨ SSLã€‚</li><li><strong>server_name <a href="http://portainer.domain.com" target="_blank" rel="noopener noreferrer">portainer.domain.com</a>;</strong>: æŒ‡å®šè¯¥æœåŠ¡å™¨å—çš„åŸŸåä¸º <code>portainer.domain.com</code>ã€‚</li><li><strong>ssl_certificate å’Œ ssl_certificate_key</strong>: æŒ‡å®š SSL è¯ä¹¦å’Œç§é’¥çš„è·¯å¾„ï¼Œç”¨äºåŠ å¯† HTTPS è¿æ¥ã€‚</li><li><strong>ssl_session_timeout 5m;</strong>: è®¾ç½® SSL ä¼šè¯çš„è¶…æ—¶æ—¶é—´ä¸º 5 åˆ†é’Ÿã€‚</li><li><strong>ssl_protocols å’Œ ssl_ciphers</strong>: é…ç½®æ”¯æŒçš„ SSL/TLS åè®®å’ŒåŠ å¯†å¥—ä»¶ï¼Œä»¥å¢å¼ºå®‰å…¨æ€§ã€‚</li><li><strong>location / { ... }</strong>: é…ç½®äº†ä¸€ä¸ªä½ç½®å—ï¼Œå¤„ç†å¯¹æ ¹è·¯å¾„çš„è¯·æ±‚ã€‚ <ul><li><strong>proxy_http_version 1.1;</strong>: è®¾ç½®ä»£ç†çš„ HTTP ç‰ˆæœ¬ä¸º 1.1ã€‚</li><li><strong>proxy_set_header Upgrade $http_upgrade;</strong>: è®¾ç½® <code>Upgrade</code> å¤´ï¼Œä»¥æ”¯æŒ WebSocketã€‚</li><li><strong>proxy_set_header Connection &quot;upgrade&quot;;</strong>: è®¾ç½® <code>Connection</code> å¤´ï¼ŒæŒ‡ç¤ºè¿æ¥å‡çº§ã€‚</li><li><strong>proxy_pass <a href="http://portainer" target="_blank" rel="noopener noreferrer">http://portainer</a>;</strong>: å°†è¯·æ±‚è½¬å‘åˆ°ä¸Šæ¸¸å®šä¹‰çš„ <code>portainer</code> æœåŠ¡å™¨ã€‚</li></ul></li></ol><p>æ€»ä½“æ¥è¯´ï¼Œè¯¥é…ç½®æ–‡ä»¶å°†æ¥è‡ª <code>portainer.domain.com</code> çš„ HTTPS è¯·æ±‚é€šè¿‡ Nginx åå‘ä»£ç†åˆ°æœ¬åœ°çš„ Portainer æœåŠ¡ï¼Œå¹¶ç¡®ä¿è¿æ¥çš„å®‰å…¨æ€§ã€‚ğŸ”’</p><h3 id="ğŸ”„-æœ€åæ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#ğŸ”„-æœ€åæ­¥éª¤"><span>ğŸ”„ æœ€åæ­¥éª¤</span></a></h3><p>åœ¨æœåŠ¡å™¨ä¸Šé‡å¯ Docker ä¸­çš„ Nginxï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è®¿é—® <code>https://portainer.domain.com:12120</code>ï¼Œå³å¯é€šè¿‡åŸŸåè®¿é—®åˆ° Portainer å®¹å™¨ã€‚ğŸŒ</p><h3 id="ğŸ“‹-æ¨¡æ¿ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ğŸ“‹-æ¨¡æ¿ä½¿ç”¨"><span>ğŸ“‹ æ¨¡æ¿ä½¿ç”¨</span></a></h3><p>ä»¥ä¸Šçš„ Portainer å®¹å™¨åå‘ä»£ç†é…ç½®æ–‡ä»¶å¯ä»¥ä½œä¸ºä¸€ä¸ªæ¨¡æ¿ï¼Œå¤§éƒ¨åˆ†æœåŠ¡éƒ½å¯ä»¥æŒ‰ç…§è¯¥æ¨¡æ¿è¿›è¡Œé…ç½®ã€‚ğŸ› ï¸ åªæœ‰æŸäº›æœåŠ¡éœ€è¦æ·»åŠ ä¸€äº›é¢å¤–é…ç½®ï¼Œè¿™ç±»æœåŠ¡åœ¨å®˜æ–¹æ–‡æ¡£ä¸­ä¸€èˆ¬éƒ½æœ‰è¯´æ˜ï¼ŒæŸ¥æ‰¾å®˜æ–¹æ–‡æ¡£å³å¯ã€‚</p>`,23))])}const F=t(d,[["render",c],["__file","5-nginx.html.vue"]]),A=JSON.parse(`{"path":"/nas/basic/5-nginx.html","title":"Nginx åå‘ä»£ç†","lang":"zh-CN","frontmatter":{"title":"Nginx åå‘ä»£ç†","order":5,"isOriginal":true,"category":["NAS"],"tag":["nginx","docker"],"description":"åœ¨ Nginx ä¸­ï¼Œå¯ä»¥å°†å„ä¸ªæœåŠ¡ä½¿ç”¨ä¸åŒçš„äºŒçº§åŸŸååå‘ä»£ç†åˆ°å…¬ç½‘ï¼Œé…åˆé˜²ç«å¢™ä»…æš´éœ²æœåŠ¡å™¨çš„å°éƒ¨åˆ†ç«¯å£ï¼Œä»è€Œæé«˜å®‰å…¨æ€§ã€‚ğŸ’¡ PSï¼šå½“åˆå¹´å°‘ä¸æ‡‚äº‹ï¼Œæ›¾å°†æ‰€æœ‰ç«¯å£æš´éœ²åˆ°å…¬ç½‘ï¼ŒåŒ…æ‹¬ æœåŠ¡ï¼Œç»“æœè¢«æŸä½æ³•å›½å¤§å…„å¼Ÿåœ¨çŸ­çŸ­ä¸‰å››ä¸ªå°æ—¶å†…å¸å¹²äº†æœºåœºæµé‡ã€‚æƒ³æƒ³è‡ªå·±å½“åˆå°†ä»£ç†ç«¯å£æ— åŠ å¯†æš´éœ²åˆ°å…¬ç½‘ï¼ŒçœŸæ˜¯ä¸ªç‹¼äººçš„æ“ä½œã€‚ğŸº ğŸš€ é€šè¿‡ Portainer Stacks å®‰è£… ...","head":[["meta",{"property":"og:url","content":"https://jayczee.cn/nas/basic/5-nginx.html"}],["meta",{"property":"og:site_name","content":"Jayczee's Blog"}],["meta",{"property":"og:title","content":"Nginx åå‘ä»£ç†"}],["meta",{"property":"og:description","content":"åœ¨ Nginx ä¸­ï¼Œå¯ä»¥å°†å„ä¸ªæœåŠ¡ä½¿ç”¨ä¸åŒçš„äºŒçº§åŸŸååå‘ä»£ç†åˆ°å…¬ç½‘ï¼Œé…åˆé˜²ç«å¢™ä»…æš´éœ²æœåŠ¡å™¨çš„å°éƒ¨åˆ†ç«¯å£ï¼Œä»è€Œæé«˜å®‰å…¨æ€§ã€‚ğŸ’¡ PSï¼šå½“åˆå¹´å°‘ä¸æ‡‚äº‹ï¼Œæ›¾å°†æ‰€æœ‰ç«¯å£æš´éœ²åˆ°å…¬ç½‘ï¼ŒåŒ…æ‹¬ æœåŠ¡ï¼Œç»“æœè¢«æŸä½æ³•å›½å¤§å…„å¼Ÿåœ¨çŸ­çŸ­ä¸‰å››ä¸ªå°æ—¶å†…å¸å¹²äº†æœºåœºæµé‡ã€‚æƒ³æƒ³è‡ªå·±å½“åˆå°†ä»£ç†ç«¯å£æ— åŠ å¯†æš´éœ²åˆ°å…¬ç½‘ï¼ŒçœŸæ˜¯ä¸ªç‹¼äººçš„æ“ä½œã€‚ğŸº ğŸš€ é€šè¿‡ Portainer Stacks å®‰è£… ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-15T06:15:38.000Z"}],["meta",{"property":"article:tag","content":"nginx"}],["meta",{"property":"article:tag","content":"docker"}],["meta",{"property":"article:modified_time","content":"2025-01-15T06:15:38.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Nginx åå‘ä»£ç†\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-01-15T06:15:38.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Jayczee\\",\\"url\\":\\"https://jayczee.cn\\"}]}"]]},"headers":[{"level":2,"title":"ğŸš€ é€šè¿‡ Portainer Stacks å®‰è£… Nginx","slug":"ğŸš€-é€šè¿‡-portainer-stacks-å®‰è£…-nginx","link":"#ğŸš€-é€šè¿‡-portainer-stacks-å®‰è£…-nginx","children":[{"level":3,"title":"ğŸ“œ æ–‡ä»¶ä¸­å‚æ•°å®šä¹‰å¦‚ä¸‹ï¼š","slug":"ğŸ“œ-æ–‡ä»¶ä¸­å‚æ•°å®šä¹‰å¦‚ä¸‹","link":"#ğŸ“œ-æ–‡ä»¶ä¸­å‚æ•°å®šä¹‰å¦‚ä¸‹","children":[]},{"level":3,"title":"ğŸ’¡ Tips","slug":"ğŸ’¡-tips","link":"#ğŸ’¡-tips","children":[]},{"level":3,"title":"ğŸ”‘ æ€»ç»“","slug":"ğŸ”‘-æ€»ç»“","link":"#ğŸ”‘-æ€»ç»“","children":[]},{"level":3,"title":"ğŸ“ åˆ›å»ºé…ç½®æ–‡ä»¶ /etc/nginx/nginx.conf","slug":"ğŸ“-åˆ›å»ºé…ç½®æ–‡ä»¶-etc-nginx-nginx-conf","link":"#ğŸ“-åˆ›å»ºé…ç½®æ–‡ä»¶-etc-nginx-nginx-conf","children":[]},{"level":3,"title":"ğŸ“‚ åˆ›å»ºæ–‡ä»¶å¤¹ /etc/nginx/conf.d","slug":"ğŸ“‚-åˆ›å»ºæ–‡ä»¶å¤¹-etc-nginx-conf-d","link":"#ğŸ“‚-åˆ›å»ºæ–‡ä»¶å¤¹-etc-nginx-conf-d","children":[]},{"level":3,"title":"ğŸ” å„éƒ¨åˆ†çš„è§£é‡Šï¼š","slug":"ğŸ”-å„éƒ¨åˆ†çš„è§£é‡Š","link":"#ğŸ”-å„éƒ¨åˆ†çš„è§£é‡Š","children":[]},{"level":3,"title":"ğŸ”„ æœ€åæ­¥éª¤","slug":"ğŸ”„-æœ€åæ­¥éª¤","link":"#ğŸ”„-æœ€åæ­¥éª¤","children":[]},{"level":3,"title":"ğŸ“‹ æ¨¡æ¿ä½¿ç”¨","slug":"ğŸ“‹-æ¨¡æ¿ä½¿ç”¨","link":"#ğŸ“‹-æ¨¡æ¿ä½¿ç”¨","children":[]}]}],"git":{"createdTime":1736491706000,"updatedTime":1736921738000,"contributors":[{"name":"Jayczee","username":"Jayczee","email":"jayczee@yeah.net","commits":4,"url":"https://github.com/Jayczee"}]},"readingTime":{"minutes":4.5,"words":1349},"filePathRelative":"nas/basic/5-nginx.md","localizedDate":"2025å¹´1æœˆ10æ—¥","excerpt":"<p>åœ¨ Nginx ä¸­ï¼Œå¯ä»¥å°†å„ä¸ªæœåŠ¡ä½¿ç”¨ä¸åŒçš„äºŒçº§åŸŸååå‘ä»£ç†åˆ°å…¬ç½‘ï¼Œé…åˆé˜²ç«å¢™ä»…æš´éœ²æœåŠ¡å™¨çš„å°éƒ¨åˆ†ç«¯å£ï¼Œä»è€Œæé«˜å®‰å…¨æ€§ã€‚ğŸ’¡ PSï¼šå½“åˆå¹´å°‘ä¸æ‡‚äº‹ï¼Œæ›¾å°†æ‰€æœ‰ç«¯å£æš´éœ²åˆ°å…¬ç½‘ï¼ŒåŒ…æ‹¬ <a href=\\"/nas/basic/9-v2rayn.html\\" target=\\"_blank\\">V2rayN ä»£ç†</a> æœåŠ¡ï¼Œç»“æœè¢«æŸä½æ³•å›½å¤§å…„å¼Ÿåœ¨çŸ­çŸ­ä¸‰å››ä¸ªå°æ—¶å†…å¸å¹²äº†æœºåœºæµé‡ã€‚æƒ³æƒ³è‡ªå·±å½“åˆå°†ä»£ç†ç«¯å£æ— åŠ å¯†æš´éœ²åˆ°å…¬ç½‘ï¼ŒçœŸæ˜¯ä¸ªç‹¼äººçš„æ“ä½œã€‚ğŸº</p>\\n<h2>ğŸš€ é€šè¿‡ Portainer Stacks å®‰è£… Nginx</h2>\\n<p>ä¸ <a href=\\"/nas/basic/3-ddns-go.html\\" target=\\"_blank\\">DDNS-GO</a> ä¸­çš„åšæ³•ç›¸åŒï¼Œé‡‡ç”¨åœ¨ Portainer Stacks ä¸­æ·»åŠ  Docker Compose æ–‡ä»¶çš„æ–¹å¼éƒ¨ç½² Nginx å®¹å™¨ã€‚ä»¥ä¸‹æ˜¯ Docker Compose æ–‡ä»¶çš„ç¤ºä¾‹ï¼š</p>","autoDesc":true}`);export{F as comp,A as data};
