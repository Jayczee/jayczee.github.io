import{f as N,u as X,g as T,h as Z,j as ee,t as te,i as le,k as D,l as x,m as l,n as ae,p as se,s as ie,R as j,q as ne,v as re,x as oe,y as ue,z as ce,A as _,B as I,D as he,C as me,E as ge,F as ve,G as de,H as ye,I as Ee,J as pe,K as M,L as Ae,M as b}from"./app-BFn2-vrM.js";const Be=["/","/code/fedex-crawler.html","/code/label-trk-reader.html","/etc/journal-to-japan.html","/nas/","/nas/jellyfin-encode-decode.html","/nas/jellyfin-font.html","/nas/qbit-category.html","/note/mysql.html","/win_linux/docker-proxy.html","/win_linux/link.html","/win_linux/linux-win-alias.html","/win_linux/ollama.html","/win_linux/openclash.html","/nas/basic/1-docker.html","/nas/basic/10-movie-pilot.html","/nas/basic/2-portainer.html","/nas/basic/3-ddns-go.html","/nas/basic/4-certbot.html","/nas/basic/5-nginx.html","/nas/basic/6-samba.html","/nas/basic/7-qbittorrent.html","/nas/basic/8-jellyfin.html","/nas/basic/9-v2rayn.html","/nas/optional/alist.html","/nas/optional/beszel.html","/nas/optional/gpt.html","/nas/optional/teamspeak.html","/note/leet150/1-leet088.html","/note/leet150/10-leet045.html","/note/leet150/11-leet274.html","/note/leet150/12-leet380.html","/note/leet150/13-leet238.html","/note/leet150/14-leet134.html","/note/leet150/15-leet135.html","/note/leet150/2-leet027.html","/note/leet150/3-leet026.html","/note/leet150/4-leet080.html","/note/leet150/5-leet169.html","/note/leet150/6-leet189.html","/note/leet150/7-leet121.html","/note/leet150/8-leet122.html","/note/leet150/9-leet055.html","/404.html","/code/","/etc/","/note/","/win_linux/","/nas/basic/","/nas/optional/","/note/leet150/","/category/","/category/code/","/category/other/","/category/nas/","/category/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","/category/linux/","/category/windows/","/category/openclash/","/category/leetcode/","/tag/","/tag/%E7%88%AC%E8%99%AB/","/tag/fedex/","/tag/python/","/tag/java/","/tag/%E6%97%A5%E6%9C%AC/","/tag/%E6%97%85%E6%B8%B8/","/tag/%E6%94%BB%E7%95%A5/","/tag/jellyfin/","/tag/%E7%BC%96%E7%A0%81%E4%B8%8E%E8%A7%A3%E7%A0%81/","/tag/%E5%AD%97%E4%BD%93%E4%B9%B1%E7%A0%81/","/tag/qbittorrent/","/tag/mysql/","/tag/docker/","/tag/proxy/","/tag/%E7%A1%AC%E9%93%BE%E6%8E%A5/","/tag/%E8%BD%AF%E9%93%BE%E6%8E%A5/","/tag/shell/","/tag/alias/","/tag/ollama/","/tag/openwrt/","/tag/openclash/","/tag/movie-pilot/","/tag/portainer/","/tag/ddns-go/","/tag/certbot/","/tag/nginx/","/tag/samba/","/tag/v2ray/","/tag/v2raya/","/tag/%E4%BB%A3%E7%90%86/","/tag/alist/","/tag/beszel/","/tag/chatgpt/","/tag/openai/","/tag/teamspeak/","/tag/leetcode%E9%9D%A2%E8%AF%95%E7%BB%8F%E5%85%B8150%E9%A2%98/","/tag/leetcode88/","/tag/%E7%AE%80%E5%8D%95%E9%A2%98/","/tag/%E6%95%B0%E7%BB%84/","/tag/%E5%8F%8C%E6%8C%87%E9%92%88/","/tag/%E6%8E%92%E5%BA%8F/","/tag/leetcode045/","/tag/%E4%B8%AD%E7%AD%89%E9%A2%98/","/tag/%E8%B4%AA%E5%BF%83/","/tag/leetcode274/","/tag/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/","/tag/leetcode380/","/tag/leetcode238/","/tag/leetcode134/","/tag/leetcode135/","/tag/%E5%9B%B0%E9%9A%BE%E9%A2%98/","/tag/leetcode27/","/tag/%E5%BF%AB%E6%85%A2%E6%8C%87%E9%92%88/","/tag/leetcode26/","/tag/leetcode169/","/tag/%E8%AE%A1%E6%95%B0/","/tag/leetcode121/","/tag/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/","/tag/leetcode122/","/tag/leetcode055/","/article/","/star/","/timeline/"],fe="SLIMSEARCH_QUERY_HISTORY",y=M(fe,[]),xe=()=>{const{queryHistoryCount:s}=b;return{enabled:s>0,queryHistories:y,addQueryHistory:r=>{y.value=Array.from(new Set([r,...y.value.slice(0,s-1)]))},removeQueryHistory:r=>{y.value=[...y.value.slice(0,r),...y.value.slice(r+1)]}}},Q=s=>Be[s.id]+("anchor"in s?`#${s.anchor}`:""),be="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:$}=b,E=M(be,[]),we=()=>({enabled:$>0,resultHistories:E,addResultHistory:n=>{{const r={link:Q(n),display:n.display};"header"in n&&(r.header=n.header),E.value=[r,...E.value.slice(0,$-1)]}},removeResultHistory:n=>{E.value=[...E.value.slice(0,n),...E.value.slice(n+1)]}}),ke=s=>{const n=he(),r=T(),w=me(),o=D(0),p=x(()=>o.value>0),h=ge([]);return ve(()=>{const{search:k,terminate:g}=de(),A=Ee(v=>{const{resultsFilter:C=a=>a,querySplitter:d,suggestionsFilter:F,...i}=n.value;v?(o.value+=1,k(v,r.value,i).then(a=>C(a,v,r.value,w.value)).then(a=>{o.value-=1,h.value=a}).catch(a=>{console.warn(a),o.value-=1,o.value||(h.value=[])})):h.value=[]},b.searchDelay-b.suggestDelay,{maxWait:5e3});ye([s,r],([v])=>A(v.join(" "))),pe(()=>{g()})}),{isSearching:p,results:h}};var He=N({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(s,{emit:n}){const r=X(),w=T(),o=Z(ee),{addQueryHistory:p,queryHistories:h,removeQueryHistory:k}=xe(),{resultHistories:g,addResultHistory:A,removeResultHistory:v}=we(),C=te(s,"queries"),{results:d,isSearching:F}=ke(C),i=le({isQuery:!0,index:0}),a=D(0),m=D(0),S=x(()=>h.value.length>0||g.value.length>0),H=x(()=>d.value.length>0),q=x(()=>d.value[a.value]||null),U=()=>{const{isQuery:e,index:t}=i;t===0?(i.isQuery=!e,i.index=e?g.value.length-1:h.value.length-1):i.index=t-1},z=()=>{const{isQuery:e,index:t}=i;t===(e?h.value.length-1:g.value.length-1)?(i.isQuery=!e,i.index=0):i.index=t+1},O=()=>{a.value=a.value>0?a.value-1:d.value.length-1,m.value=q.value.contents.length-1},P=()=>{a.value=a.value<d.value.length-1?a.value+1:0,m.value=0},Y=()=>{m.value<q.value.contents.length-1?m.value+=1:P()},G=()=>{m.value>0?m.value-=1:O()},R=e=>e.map(t=>Ae(t)?t:l(t[0],t[1])),J=e=>{if(e.type==="customField"){const t=ue[e.index]||"$content",[u,f=""]=ce(t)?t[w.value].split("$content"):t.split("$content");return e.display.map(c=>l("div",R([u,...c,f])))}return e.display.map(t=>l("div",R(t)))},B=()=>{a.value=0,m.value=0,n("updateQuery",""),n("close")},K=()=>l("ul",{class:"slimsearch-result-list"},l("li",{class:"slimsearch-result-list-item"},[l("div",{class:"slimsearch-result-title"},o.value.queryHistory),h.value.map((e,t)=>l("div",{class:["slimsearch-result-item",{active:i.isQuery&&i.index===t}],onClick:()=>{n("updateQuery",e)}},[l(_,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},e),l("button",{class:"slimsearch-remove-icon",innerHTML:I,onClick:u=>{u.preventDefault(),u.stopPropagation(),k(t)}})]))])),V=()=>l("ul",{class:"slimsearch-result-list"},l("li",{class:"slimsearch-result-list-item"},[l("div",{class:"slimsearch-result-title"},o.value.resultHistory),g.value.map((e,t)=>l(j,{to:e.link,class:["slimsearch-result-item",{active:!i.isQuery&&i.index===t}],onClick:()=>{B()}},()=>[l(_,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},[e.header?l("div",{class:"content-header"},e.header):null,l("div",e.display.map(u=>R(u)).flat())]),l("button",{class:"slimsearch-remove-icon",innerHTML:I,onClick:u=>{u.preventDefault(),u.stopPropagation(),v(t)}})]))]));return ae("keydown",e=>{if(s.isFocusing){if(H.value){if(e.key==="ArrowUp")G();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const t=q.value.contents[m.value];p(s.queries.join(" ")),A(t),r.push(Q(t)),B()}}else if(e.key==="ArrowUp")U();else if(e.key==="ArrowDown")z();else if(e.key==="Enter"){const{index:t}=i;i.isQuery?(n("updateQuery",h.value[t]),e.preventDefault()):(r.push(g.value[t].link),B())}}}),se([a,m],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>l("div",{class:["slimsearch-result-wrapper",{empty:s.queries.length?!H.value:!S.value}],id:"slimsearch-results"},s.queries.length?F.value?l(ie,{hint:o.value.searching}):H.value?l("ul",{class:"slimsearch-result-list"},d.value.map(({title:e,contents:t},u)=>{const f=a.value===u;return l("li",{class:["slimsearch-result-list-item",{active:f}]},[l("div",{class:"slimsearch-result-title"},e||o.value.defaultTitle),t.map((c,W)=>{const L=f&&m.value===W;return l(j,{to:Q(c),class:["slimsearch-result-item",{active:L,"aria-selected":L}],onClick:()=>{p(s.queries.join(" ")),A(c),B()}},()=>[c.type==="text"?null:l(c.type==="title"?ne:c.type==="heading"?re:oe,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},[c.type==="text"&&c.header?l("div",{class:"content-header"},c.header):null,l("div",J(c))])])})])})):o.value.emptyResult:S.value?[K(),V()]:o.value.emptyHistory)}});export{He as default};
