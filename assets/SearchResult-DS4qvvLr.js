import{u as U,g as ee,h as te,i as z,j as le,k as ae,t as se,l as ie,m as F,n as x,p as ne,w as re,q as l,v as ue,R as _,x as oe,y as ce,z as me,D as he,A as ve,B as de,C as ge,E as ye,F as Ee,G as pe,H as Ae,I as fe,J as $,K as T,L as Be,M as w,N as be}from"./app-BpRl8Ce5.js";const xe=["/","/code/fedex-crawler.html","/code/label-trk-reader.html","/note/mysql.html","/nas/","/nas/jellyfin-encode-decode.html","/nas/jellyfin-font.html","/nas/qbit-category.html","/win_linux/docker-proxy.html","/win_linux/link.html","/win_linux/linux-win-alias.html","/win_linux/ollama.html","/note/leet150/1-leet088.html","/note/leet150/10-leet045.html","/note/leet150/11-leet274.html","/note/leet150/12-leet380.html","/note/leet150/13-leet238.html","/note/leet150/14-leet134.html","/note/leet150/2-leet027.html","/note/leet150/3-leet026.html","/note/leet150/4-leet080.html","/note/leet150/5-leet169.html","/note/leet150/6-leet189.html","/note/leet150/7-leet121.html","/note/leet150/8-leet122.html","/note/leet150/9-leet055.html","/nas/basic/1-docker.html","/nas/basic/10-movie-pilot.html","/nas/basic/2-portainer.html","/nas/basic/3-ddns-go.html","/nas/basic/4-certbot.html","/nas/basic/5-nginx.html","/nas/basic/6-samba.html","/nas/basic/7-qbittorrent.html","/nas/basic/8-jellyfin.html","/nas/basic/9-v2rayn.html","/nas/optional/alist.html","/nas/optional/beszel.html","/nas/optional/gpt.html","/nas/optional/teamspeak.html","/404.html","/code/","/note/","/win_linux/","/note/leet150/","/nas/basic/","/nas/optional/","/category/","/category/code/","/category/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","/category/nas/","/category/linux/","/category/windows/","/category/leetcode/","/tag/","/tag/%E7%88%AC%E8%99%AB/","/tag/fedex/","/tag/python/","/tag/java/","/tag/mysql/","/tag/jellyfin/","/tag/%E7%BC%96%E7%A0%81%E4%B8%8E%E8%A7%A3%E7%A0%81/","/tag/%E5%AD%97%E4%BD%93%E4%B9%B1%E7%A0%81/","/tag/qbittorrent/","/tag/docker/","/tag/proxy/","/tag/%E7%A1%AC%E9%93%BE%E6%8E%A5/","/tag/%E8%BD%AF%E9%93%BE%E6%8E%A5/","/tag/shell/","/tag/alias/","/tag/ollama/","/tag/leetcode%E9%9D%A2%E8%AF%95%E7%BB%8F%E5%85%B8150%E9%A2%98/","/tag/leetcode88/","/tag/%E7%AE%80%E5%8D%95%E9%A2%98/","/tag/%E6%95%B0%E7%BB%84/","/tag/%E5%8F%8C%E6%8C%87%E9%92%88/","/tag/%E6%8E%92%E5%BA%8F/","/tag/leetcode045/","/tag/%E4%B8%AD%E7%AD%89%E9%A2%98/","/tag/%E8%B4%AA%E5%BF%83/","/tag/leetcode274/","/tag/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/","/tag/leetcode380/","/tag/leetcode238/","/tag/leetcode134/","/tag/leetcode27/","/tag/%E5%BF%AB%E6%85%A2%E6%8C%87%E9%92%88/","/tag/leetcode26/","/tag/leetcode169/","/tag/%E8%AE%A1%E6%95%B0/","/tag/leetcode121/","/tag/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/","/tag/leetcode122/","/tag/leetcode055/","/tag/movie-pilot/","/tag/portainer/","/tag/ddns-go/","/tag/certbot/","/tag/nginx/","/tag/samba/","/tag/v2ray/","/tag/v2raya/","/tag/%E4%BB%A3%E7%90%86/","/tag/alist/","/tag/beszel/","/tag/chatgpt/","/tag/openai/","/tag/teamspeak/","/article/","/star/","/timeline/"],we="SLIMSEARCH_QUERY_HISTORY",y=U(we,[]),ke=()=>{const{queryHistoryCount:a}=w,s=a>0;return{enabled:s,queryHistories:y,addQueryHistory:i=>{s&&(y.value=Array.from(new Set([i,...y.value.slice(0,a-1)])))},removeQueryHistory:i=>{y.value=[...y.value.slice(0,i),...y.value.slice(i+1)]}}},S=a=>xe[a.id]+("anchor"in a?`#${a.anchor}`:""),He="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:M}=w,E=U(He,[]),Ce=()=>{const a=M>0;return{enabled:a,resultHistories:E,addResultHistory:s=>{if(a){const i={link:S(s),display:s.display};"header"in s&&(i.header=s.header),E.value=[i,...E.value.slice(0,M-1)]}},removeResultHistory:s=>{E.value=[...E.value.slice(0,s),...E.value.slice(s+1)]}}},qe=a=>{const s=he(),i=z(),k=ve(),r=F(0),A=x(()=>r.value>0),d=de([]);return ge(()=>{const{search:g,terminate:H}=ye(),p=Be(o=>{const{resultsFilter:f=u=>u,querySplitter:L,suggestionsFilter:C,...q}=s.value;o?(r.value+=1,g(o,i.value,q).then(u=>f(u,o,i.value,k.value)).then(u=>{r.value-=1,d.value=u}).catch(u=>{console.warn(u),r.value-=1,r.value||(d.value=[])})):d.value=[]},w.searchDelay-w.suggestDelay,{maxWait:5e3});Ee([a,i],([o])=>p(o.join(" "))),pe(()=>{H()})}),{isSearching:A,results:d}};var De=ee({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:s}){const i=te(),k=z(),r=le(ae),{enabled:A,addQueryHistory:d,queryHistories:g,removeQueryHistory:H}=ke(),{enabled:p,resultHistories:o,addResultHistory:f,removeResultHistory:L}=Ce(),C=A||p,q=se(a,"queries"),{results:u,isSearching:O}=qe(q),n=ie({isQuery:!0,index:0}),h=F(0),v=F(0),j=x(()=>C&&(g.value.length>0||o.value.length>0)),R=x(()=>u.value.length>0),D=x(()=>u.value[h.value]||null),P=()=>{const{isQuery:e,index:t}=n;t===0?(n.isQuery=!e,n.index=e?o.value.length-1:g.value.length-1):n.index=t-1},Y=()=>{const{isQuery:e,index:t}=n;t===(e?g.value.length-1:o.value.length-1)?(n.isQuery=!e,n.index=0):n.index=t+1},G=()=>{h.value=h.value>0?h.value-1:u.value.length-1,v.value=D.value.contents.length-1},J=()=>{h.value=h.value<u.value.length-1?h.value+1:0,v.value=0},K=()=>{v.value<D.value.contents.length-1?v.value+=1:J()},N=()=>{v.value>0?v.value-=1:G()},Q=e=>e.map(t=>be(t)?t:l(t[0],t[1])),V=e=>{if(e.type==="customField"){const t=Ae[e.index]||"$content",[c,b=""]=fe(t)?t[k.value].split("$content"):t.split("$content");return e.display.map(m=>l("div",Q([c,...m,b])))}return e.display.map(t=>l("div",Q(t)))},B=()=>{h.value=0,v.value=0,s("updateQuery",""),s("close")},W=()=>A?l("ul",{class:"slimsearch-result-list"},l("li",{class:"slimsearch-result-list-item"},[l("div",{class:"slimsearch-result-title"},r.value.queryHistory),g.value.map((e,t)=>l("div",{class:["slimsearch-result-item",{active:n.isQuery&&n.index===t}],onClick:()=>{s("updateQuery",e)}},[l($,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},e),l("button",{class:"slimsearch-remove-icon",innerHTML:T,onClick:c=>{c.preventDefault(),c.stopPropagation(),H(t)}})]))])):null,X=()=>p?l("ul",{class:"slimsearch-result-list"},l("li",{class:"slimsearch-result-list-item"},[l("div",{class:"slimsearch-result-title"},r.value.resultHistory),o.value.map((e,t)=>l(_,{to:e.link,class:["slimsearch-result-item",{active:!n.isQuery&&n.index===t}],onClick:()=>{B()}},()=>[l($,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},[e.header?l("div",{class:"content-header"},e.header):null,l("div",e.display.map(c=>Q(c)).flat())]),l("button",{class:"slimsearch-remove-icon",innerHTML:T,onClick:c=>{c.preventDefault(),c.stopPropagation(),L(t)}})]))])):null;return ne("keydown",e=>{if(a.isFocusing){if(R.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const t=D.value.contents[v.value];d(a.queries.join(" ")),f(t),i.push(S(t)),B()}}else if(p){if(e.key==="ArrowUp")P();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:t}=n;n.isQuery?(s("updateQuery",g.value[t]),e.preventDefault()):(i.push(o.value[t].link),B())}}}}),re([h,v],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>l("div",{class:["slimsearch-result-wrapper",{empty:a.queries.length?!R.value:!j.value}],id:"slimsearch-results"},a.queries.length?O.value?l(ue,{hint:r.value.searching}):R.value?l("ul",{class:"slimsearch-result-list"},u.value.map(({title:e,contents:t},c)=>{const b=h.value===c;return l("li",{class:["slimsearch-result-list-item",{active:b}]},[l("div",{class:"slimsearch-result-title"},e||r.value.defaultTitle),t.map((m,Z)=>{const I=b&&v.value===Z;return l(_,{to:S(m),class:["slimsearch-result-item",{active:I,"aria-selected":I}],onClick:()=>{d(a.queries.join(" ")),f(m),B()}},()=>[m.type==="text"?null:l(m.type==="title"?oe:m.type==="heading"?ce:me,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},[m.type==="text"&&m.header?l("div",{class:"content-header"},m.header):null,l("div",V(m))])])})])})):r.value.emptyResult:C?j.value?[W(),X()]:r.value.emptyHistory:r.value.emptyResult)}});export{De as default};
