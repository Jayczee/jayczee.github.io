---
title: 238 é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯
order: 13
category:
    - LeetCode
tag:
    - LeetCodeé¢è¯•ç»å…¸150é¢˜
    - LeetCode238
    - ä¸­ç­‰é¢˜
    - æ•°ç»„
---

## ğŸ“š ç›¸å…³é“¾æ¥

[LeetCode 238: é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯](https://leetcode.cn/problems/product-of-array-except-self/description/?envType=study-plan-v2&envId=top-interview-150)

## ğŸ“ é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums`ï¼Œè¿”å›æ•°ç»„ `answer`ï¼Œå…¶ä¸­ `answer[i]` ç­‰äº `nums` ä¸­é™¤ `nums[i]` ä¹‹å¤–å…¶ä½™å„å…ƒç´ çš„ä¹˜ç§¯ã€‚

**è¦æ±‚ï¼š**  
- ä¸è¦ä½¿ç”¨é™¤æ³•ï¼Œä¸”åœ¨ O(n) æ—¶é—´å¤æ‚åº¦å†…å®Œæˆæ­¤é¢˜ã€‚

## ğŸ’¡ ç¤ºä¾‹

### ç¤ºä¾‹ 1
**è¾“å…¥:**  
```plaintext
nums = [1, 2, 3, 4]
```
**è¾“å‡º:**  
```plaintext
[24, 12, 8, 6]
```

### ç¤ºä¾‹ 2
**è¾“å…¥:**  
```plaintext
nums = [-1, 1, 0, -3, 3]
```
**è¾“å‡º:**  
```plaintext
[0, 0, 9, 0, 0]
```

## âš ï¸ æç¤º
- `2 <= nums.length <= 10^5`
- `-30 <= nums[i] <= 30`
- è¾“å…¥ä¿è¯æ•°ç»„ `answer[i]` åœ¨ 32 ä½æ•´æ•°èŒƒå›´å†…

## ğŸ” è¿›é˜¶
å¯ä»¥åœ¨ O(1) çš„é¢å¤–ç©ºé—´å¤æ‚åº¦å†…å®Œæˆè¿™ä¸ªé¢˜ç›®å—ï¼Ÿï¼ˆå‡ºäºå¯¹ç©ºé—´å¤æ‚åº¦åˆ†æçš„ç›®çš„ï¼Œè¾“å‡ºæ•°ç»„ä¸è¢«è§†ä¸ºé¢å¤–ç©ºé—´ã€‚ï¼‰

## ğŸ’­ æ€è·¯

1. ç»´æŠ¤ä¸¤ä¸ªæ•°ç»„ï¼Œä¸€ä¸ª `prefix` ä¸€ä¸ª `suffix`ï¼Œä½¿ç”¨ä¸¤ä¸ªå¾ªç¯å¡«å……è¿™ä¸¤ä¸ªæ•°ç»„ï¼š

   - `prefix[i]` ä¸ºç¬¬ `i` ä¸ªå…ƒç´ ä¹‹å‰çš„æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯
   - `suffix[i]` ä¸ºç¬¬ `i` ä¸ªå…ƒç´ ä¹‹åçš„æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯

   å› æ­¤ï¼Œ`ans[i] = prefix[i] * suffix[i]`ã€‚

2. è¿›é˜¶å®ç°

   ç”±äºè¾“å‡ºæ•°ç»„ä¸ç®—é¢å¤–ç©ºé—´ï¼Œæ‰€ä»¥å…ˆå°† `prefix` æ”¾è¿› `ans`ï¼Œå†æŠŠ `suffix` ä¹˜åˆ° `ans` ä¸Šã€‚

## ğŸ’» ä»£ç å®ç°

### 1. ç»´æŠ¤ä¸¤ä¸ªæ•°ç»„

```java
public int[] productExceptSelf(int[] nums) {
    if (nums.length == 2) {
        return new int[]{nums[1], nums[0]};
    }

    int[] ans = new int[nums.length];
    int[] pre = new int[nums.length];
    int[] suf = new int[nums.length];

    for (int i = 0; i < nums.length; i++) {
        if (i == 0) {
            pre[i] = 1;
        } else {
            pre[i] = pre[i - 1] * nums[i - 1];
        }
    }

    for (int i = nums.length - 1; i >= 0; i--) {
        if (i == nums.length - 1) {
            suf[i] = 1;
        } else {
            suf[i] = suf[i + 1] * nums[i + 1];
        }
    }

    for (int i = 0; i < nums.length; i++) {
        ans[i] = pre[i] * suf[i];
    }

    return ans;
}
```

### 2. åŠ¨æ€ç»´æŠ¤ `suffix` å’Œ `prefix`

```java
public int[] productExceptSelf(int[] nums) {
    if (nums.length == 2) {
        return new int[]{nums[1], nums[0]};
    }

    int[] ans = new int[nums.length];

    for (int i = 0; i < nums.length; i++) {
        if (i == 0) {
            ans[i] = 1;
        } else {
            ans[i] = ans[i - 1] * nums[i - 1];
        }
    }

    int R = 1;
    for (int i = nums.length - 1; i >= 0; i--) {
        ans[i] *= R;
        R *= nums[i];
    }

    return ans;
}
```