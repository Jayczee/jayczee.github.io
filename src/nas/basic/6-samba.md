---
title: Samba æ–‡ä»¶å…±äº«æœåŠ¡é…ç½®
order: 6
isOriginal: true
category:
    - NAS
tag:
    - samba
    - docker
---

## ğŸ“– ä»€ä¹ˆæ˜¯ Sambaï¼Ÿ

**Samba** æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå…è®¸åœ¨ Linux å’Œ Windows ç³»ç»Ÿä¹‹é—´å…±äº«æ–‡ä»¶å’Œæ‰“å°æœºã€‚å®ƒå®ç°äº† SMB/CIFS åè®®ï¼Œä½¿å¾—ä¸åŒæ“ä½œç³»ç»Ÿä¹‹é—´èƒ½å¤Ÿæ— ç¼åœ°è¿›è¡Œæ–‡ä»¶å…±äº«ã€‚Samba è¢«å¹¿æ³›åº”ç”¨äºå®¶åº­å’Œä¼ä¸šç½‘ç»œä¸­ï¼Œå¯ä»¥è½»æ¾åœ°å°† Linux æœåŠ¡å™¨æˆ– NAS (ç½‘ç»œé™„å±å­˜å‚¨) å˜æˆæ–‡ä»¶å…±äº«æœåŠ¡å™¨ã€‚

## ğŸš€ Samba çš„ä¼˜åŠ¿

- **è·¨å¹³å°æ”¯æŒ**ï¼šSamba ä½¿å¾— Windows å’Œ Linux ç³»ç»Ÿä¹‹é—´çš„æ–‡ä»¶å…±äº«å˜å¾—ç®€å•ï¼Œç”¨æˆ·å¯ä»¥åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šè®¿é—®å…±äº«æ–‡ä»¶ã€‚
- **æƒé™ç®¡ç†**ï¼šé€šè¿‡ Sambaï¼Œç”¨æˆ·å¯ä»¥çµæ´»åœ°è®¾ç½®æ–‡ä»¶å’Œç›®å½•çš„è®¿é—®æƒé™ï¼Œç¡®ä¿æ•°æ®å®‰å…¨ã€‚
- **æ˜“äºé…ç½®**ï¼šSamba æä¾›äº†ç®€å•çš„é…ç½®æ–‡ä»¶ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€æ±‚å¿«é€Ÿè¿›è¡Œè®¾ç½®ã€‚

## ğŸ› ï¸ ä½¿ç”¨ Docker éƒ¨ç½² Samba

é€šè¿‡ Docker éƒ¨ç½² Samba æ˜¯ä¸€ç§ä¾¿æ·çš„æ–¹å¼ï¼Œå¯ä»¥å¿«é€Ÿæ­å»ºæ–‡ä»¶å…±äº«æœåŠ¡ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ Docker Compose é…ç½®ç¤ºä¾‹ï¼Œç”¨äºå¯åŠ¨ Samba æœåŠ¡ã€‚

### Docker Compose é…ç½®

```yaml
services:
  samba:
    image: dperson/samba
    container_name: samba
    ports:
      - "139:139"
      - "445:445"
    volumes:
      - /mnt/data_hdd:/share_dir
    command: >
      -u "root;"
      -s "SmbShare;/share_dir/;yes;no;yes;all;root;;"
    restart: unless-stopped
```

### é…ç½®è¯´æ˜

- **image**: ä½¿ç”¨ `dperson/samba` é•œåƒï¼Œè¿™ä¸ªé•œåƒæ˜¯ä¸€ä¸ªè½»é‡çº§çš„ Samba æœåŠ¡å™¨ã€‚
- **container_name**: è®¾ç½®å®¹å™¨çš„åç§°ä¸º `samba`ï¼Œä¾¿äºç®¡ç†ã€‚
- **ports**: æ˜ å°„ Samba æœåŠ¡çš„ç«¯å£ï¼Œä»¥ä¾¿å¤–éƒ¨è®¿é—®ï¼š
  - `139`: NetBIOS ä¼šè¯æœåŠ¡
  - `445`: SMB/CIFS æœåŠ¡
- **volumes**: å°†å®¿ä¸»æœºçš„ `/mnt/data_hdd` ç›®å½•æŒ‚è½½åˆ°å®¹å™¨å†…çš„ `/share_dir` ç›®å½•ï¼Œå…è®¸å…±äº«æ–‡ä»¶ã€‚æ­¤å¤„ç›´æ¥åŒæ­¥æŒ‚è½½åˆ°å®¹å™¨çš„ `/share_dir` å†…ï¼Œä¿è¯å®¹å™¨ä¹Ÿèƒ½è®¿é—®åé¢æ·»åŠ çš„ç¡¬ç›˜ã€‚
- **command**: æŒ‡å®š Samba çš„å¯åŠ¨å‘½ä»¤ï¼š
  - `-u "root;"` è¡¨ç¤ºä½¿ç”¨ root ç”¨æˆ·ï¼Œä¸”ä¸è®¾ç½®å¯†ç ã€‚
  - `-s "SmbShare;/share_dir/;yes;no;yes;all;root;;"` è¡¨ç¤ºå…±äº« `/share_dir` ç›®å½•ï¼Œå¹¶è®¾ç½®ä¸ºå¯è¯»å†™ï¼Œå…è®¸æ‰€æœ‰ç”¨æˆ·è®¿é—®ã€‚
- **restart**: è®¾ç½®å®¹å™¨ä¸º `unless-stopped`ï¼Œç¡®ä¿å®¹å™¨åœ¨æ„å¤–é€€å‡ºæ—¶è‡ªåŠ¨é‡å¯ã€‚

## âš ï¸ æ³¨æ„äº‹é¡¹

- **å®‰å…¨æ€§**ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸å»ºè®®ä½¿ç”¨ root ç”¨æˆ·å’Œç©ºå¯†ç ã€‚åº”åˆ›å»ºä¸“ç”¨ç”¨æˆ·å¹¶è®¾ç½®å¼ºå¯†ç ã€‚æ­¤å¤„æˆ‘ä½¿ç”¨sambaæœåŠ¡ä»…ä¸ºäº†å†…ç½‘æœºå™¨äº’ç›¸è¿æ¥ï¼Œä¸ºäº†æˆ‘å¯ä»¥åœ¨ä¸ªäººPCä¸Šæ–¹ä¾¿ç®¡ç†NASçš„æ–‡ä»¶ï¼Œæ‰€ä»¥æ²¡æœ‰è®¾ç½®å¯†ç ã€‚
- **é˜²ç«å¢™è®¾ç½®**ï¼šç¡®ä¿å®¿ä¸»æœºçš„é˜²ç«å¢™å…è®¸ Samba æœåŠ¡çš„ç«¯å£è®¿é—®ã€‚

## ğŸ” è®¿é—® Samba å…±äº«

1. **å¯åŠ¨ Docker å®¹å™¨**ï¼š
   åœ¨Portainerçš„Stack Web Editorä¸­æ·»åŠ ä¸Šè¿°é…ç½®æ–‡ä»¶ï¼Œç‚¹å‡»Deploy the stackéƒ¨ç½²samba dockeræœåŠ¡ã€‚

2. **è®¿é—® Samba å…±äº«**ï¼š
   - Windows ç³»ç»Ÿä¸­ï¼Œå¯ä»¥åœ¨æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­è¾“å…¥ `\\<å®¿ä¸»æœºIP>\mnt` è®¿é—®å…±äº«æ–‡ä»¶å¤¹ã€‚
   - Linux ç³»ç»Ÿä¸­ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡ŒæŒ‚è½½ Samba å…±äº«ï¼š
     ```bash
     sudo mount -t cifs //<å®¿ä¸»æœºIP>/mnt /mnt -o username=root,password=
     ```