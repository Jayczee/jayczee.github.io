---
title: 远程开机WakeOnLan踩坑
category:
    - Linux
    - Windows
tag:
    - openwrt
    - openclash
    - wakeonlan
---

平常我到公司，都是通过WOL唤醒家里的Windows，然后远程连接进行开发，主要是家里电脑性能好，多开前后端项目不卡顿。

昨晚半夜醒来，发现房间黑不溜秋的，判断是小区停电了，果不其然，大概过了半个小时左右来了电，第二天早上迷糊着急匆匆的去上班，没多管。

到了公司按例进行远程唤醒操作：
1. ssh家里常开的nas
2. nas作为跳板机ssh到路由器
3. 路由器arp -a找到主力机的mac地址
4. 使用mac地址进行远程唤醒

这次到了第一步，我就直接卡住了。怎么也连不上，猛的想起来昨晚停电，nas断电后我没开机。

好在家里有一台24小时常开的笔记本，这台笔记本上恰巧有UU远程，于是通过UU远程连接到笔记本。随后在笔记本上ssh到路由器上。至此，第2步直接就完成了。

第三部，通过arp -a找到主力机mac，结果发现，由于断电，dhcp租约记录什么缓存之类的全部消失了，我丢失了主力机的mac，无法远程唤醒。

询问chatgpt，折腾几分钟后，确认无法用包括但不限于查看日志、查看终端历史等手段找到主力机的mac，无法恢复。

以为就此要凉凉的时候，我突然想到，为了防止家里的公网ip哪天由于不明原因宕机，我在主力机上安装过ToDesk、UU远程以及向日葵。他们之一是会记录目标机器的mac地址的。

没错，就是你，伟大的向日葵。

平常我终极嫌弃，卡顿的要死，限制也多，几百年没连接过的向日葵。我在设备列表中找到离线的目标机器，查看信息，mac地址赫然在列。

现在mac地址也有了，在路由器ssh上etherwake了一下，等待1分钟，无果。

多次尝试无效，最后再次询问gpt，得知设备断电后至少要给电一次，保证网卡有电，才能使用wol。

GG！

现在在用自己放在公司的macbook pro无奈写下这篇文章，但是只有8g，勉强凑合着开发吧。。。。。。